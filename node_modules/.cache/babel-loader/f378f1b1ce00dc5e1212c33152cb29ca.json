{"ast":null,"code":"var _jsxFileName = \"/home/danielmelchor/Documents/CodeProjects/Decentrapass/Website/src/pages/App/Register/Register.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\nimport { hash } from \"../../../functions/encryption\";\nimport { changePage, saveLogin, saveTx } from \"../../../state/actions\";\nimport LogoNBG from \"../../../img/logo-nobg.png\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst mapStateToProps = state => {\n  return {\n    contract: state.contract,\n    account: state.account\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    changePage: page => dispatch(changePage(page)),\n    saveLogin: bool => dispatch(saveLogin(bool)),\n    saveTx: tx => dispatch(saveTx(tx))\n  };\n};\n\nexport class Register extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pass: \"\",\n      redirect: null\n    };\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  async componentDidUpdate() {\n    if (this.props.contract) {\n      let pass = await this.props.contract.methods.password(this.props.account).call();\n\n      if (pass && pass !== \"\") {\n        this.setState({\n          redirect: /*#__PURE__*/_jsxDEV(Redirect, {\n            to: \"/app/login\"\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 43,\n            columnNumber: 35\n          }, this)\n        });\n      }\n    }\n  }\n\n  async handleSubmit(e) {\n    e.preventDefault();\n    let pass = hash(this.state.pass, this.props.account);\n    this.props.contract.methods.setPass(pass).send({\n      from: this.props.account\n    }).on(\"transactionHash\", function (hash) {\n      this.props.saveTx(hash);\n    }.bind(this));\n    this.props.saveLogin(true);\n    this.setState({\n      redirect: /*#__PURE__*/_jsxDEV(Redirect, {\n        to: \"/app/unlocked\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 63,\n        columnNumber: 31\n      }, this)\n    });\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [this.state.redirect, /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"flex flex-col items-center justify-center w-full h-full\",\n        children: /*#__PURE__*/_jsxDEV(\"form\", {\n          className: \"flex form w-11/12 lg:w-1/2 h-16\",\n          onSubmit: this.handleSubmit,\n          children: [/*#__PURE__*/_jsxDEV(\"input\", {\n            id: \"unlock-input\",\n            type: \"password\",\n            className: \"w-full border-2 border-solid dark:text-white bg-gray-300 border-gray-300 dark:bg-gray-700 dark:border-gray-700 text-xl lg:text-2xl px-5 py-3 focus:outline-none focus:border-blue-500 dark:focus:outline-none dark:focus:border-blue-500 rounded-bl-xl\",\n            placeholder: \"Enter a new master password\",\n            onChange: e => {\n              this.setState({\n                pass: e.target.value\n              });\n            },\n            autoFocus: true\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 75,\n            columnNumber: 13\n          }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n            type: \"submit\",\n            className: \"bg-blue-500 border-blue-500 py-3 px-4 rounded-tr-xl\",\n            children: /*#__PURE__*/_jsxDEV(\"img\", {\n              src: LogoNBG,\n              className: \"h-full\"\n            }, void 0, false, {\n              fileName: _jsxFileName,\n              lineNumber: 89,\n              columnNumber: 15\n            }, this)\n          }, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 85,\n            columnNumber: 13\n          }, this)]\n        }, void 0, true, {\n          fileName: _jsxFileName,\n          lineNumber: 71,\n          columnNumber: 11\n        }, this)\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 70,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\nexport default connect(mapStateToProps, mapDispatchToProps)(Register);","map":{"version":3,"sources":["/home/danielmelchor/Documents/CodeProjects/Decentrapass/Website/src/pages/App/Register/Register.js"],"names":["React","Component","connect","Redirect","hash","changePage","saveLogin","saveTx","LogoNBG","mapStateToProps","state","contract","account","mapDispatchToProps","dispatch","page","bool","tx","Register","constructor","props","pass","redirect","handleSubmit","bind","componentDidUpdate","methods","password","call","setState","e","preventDefault","setPass","send","from","on","render","target","value"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { Redirect } from \"react-router-dom\";\n\nimport { hash } from \"../../../functions/encryption\";\nimport { changePage, saveLogin, saveTx } from \"../../../state/actions\";\n\nimport LogoNBG from \"../../../img/logo-nobg.png\";\n\nconst mapStateToProps = (state) => {\n  return {\n    contract: state.contract,\n    account: state.account,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    changePage: (page) => dispatch(changePage(page)),\n    saveLogin: (bool) => dispatch(saveLogin(bool)),\n    saveTx: (tx) => dispatch(saveTx(tx)),\n  };\n};\n\nexport class Register extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      pass: \"\",\n      redirect: null,\n    };\n\n    this.handleSubmit = this.handleSubmit.bind(this);\n  }\n\n  async componentDidUpdate() {\n    if (this.props.contract) {\n      let pass = await this.props.contract.methods\n        .password(this.props.account)\n        .call();\n\n      if (pass && pass !== \"\") {\n        this.setState({ redirect: <Redirect to=\"/app/login\" /> });\n      }\n    }\n  }\n\n  async handleSubmit(e) {\n    e.preventDefault();\n\n    let pass = hash(this.state.pass, this.props.account);\n\n    this.props.contract.methods\n      .setPass(pass)\n      .send({ from: this.props.account })\n      .on(\n        \"transactionHash\",\n        function (hash) {\n          this.props.saveTx(hash);\n        }.bind(this)\n      );\n    this.props.saveLogin(true);\n    this.setState({ redirect: <Redirect to=\"/app/unlocked\" /> });\n  }\n\n  render() {\n    return (\n      <>\n        {this.state.redirect}\n        <div className=\"flex flex-col items-center justify-center w-full h-full\">\n          <form\n            className=\"flex form w-11/12 lg:w-1/2 h-16\"\n            onSubmit={this.handleSubmit}\n          >\n            <input\n              id=\"unlock-input\"\n              type=\"password\"\n              className=\"w-full border-2 border-solid dark:text-white bg-gray-300 border-gray-300 dark:bg-gray-700 dark:border-gray-700 text-xl lg:text-2xl px-5 py-3 focus:outline-none focus:border-blue-500 dark:focus:outline-none dark:focus:border-blue-500 rounded-bl-xl\"\n              placeholder=\"Enter a new master password\"\n              onChange={(e) => {\n                this.setState({ pass: e.target.value });\n              }}\n              autoFocus\n            />\n            <button\n              type=\"submit\"\n              className=\"bg-blue-500 border-blue-500 py-3 px-4 rounded-tr-xl\"\n            >\n              <img src={LogoNBG} className=\"h-full\" />\n            </button>\n          </form>\n        </div>\n      </>\n    );\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(Register);\n"]},"metadata":{},"sourceType":"module"}