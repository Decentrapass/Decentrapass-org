{"ast":null,"code":"var _jsxFileName = \"/home/danielmelchor/Documents/CodeProjects/Decentrapass/Website/src/routers/AppRouter.js\";\nimport React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\nimport { changeAccount, saveWeb3, savePassword, saveContract } from \"../state/actions\";\nimport { Switch, Route, Redirect } from \"react-router-dom\";\nimport Web3 from \"web3\";\nimport { TOKEN_ABI, TOKEN_ADDRESS } from \"../web3/web3constants\";\nimport AppNav from \"../components/AppNav/AppNav\";\nimport NotFound from \"../pages/NotFound/NotFound\";\nimport ConnectMetamask from \"../components/Messages/ConnectMetamask\";\nimport AddItem from \"../pages/App/AddItem/AddItem\";\nimport EditItem from \"../pages/App/EditItem/EditItem\";\nimport Login from \"../pages/App/Login/Login\";\nimport Register from \"../pages/App/Register/Register\";\nimport Unlocked from \"../pages/App/Unlocked/Unlocked\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nimport { Fragment as _Fragment } from \"react/jsx-dev-runtime\";\n\nconst mapStateToProps = state => {\n  return {\n    web3: state.web3\n  };\n};\n\nconst mapDispatchToProps = dispatch => {\n  return {\n    changeAccount: acc => dispatch(changeAccount(acc)),\n    saveWeb3: web3item => dispatch(saveWeb3(web3item)),\n    saveContract: Contract => dispatch(saveContract(Contract)),\n    savePassword: pass => dispatch(savePassword(pass))\n  };\n};\n\nclass AppRouter extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: false,\n      render: null,\n      metamaskEnabled: null\n    };\n    this.connectMetamask = this.connectMetamask.bind(this);\n    this.saveConnection = this.saveConnection.bind(this);\n  }\n\n  async connectMetamask() {\n    var accessAllowed = false;\n\n    try {\n      await window.ethereum.request({\n        method: \"eth_requestAccounts\"\n      });\n      accessAllowed = true;\n    } catch (e) {\n      console.log(\"MM Error:\", e);\n    }\n\n    if (accessAllowed) {\n      await this.saveConnection();\n      window.ethereum.on(\"accountsChanged\", async function (accounts) {\n        window.location.reload();\n      });\n      window.ethereum.on(\"networkChanged\", function (networkId) {\n        window.location.reload();\n      });\n    }\n  }\n\n  async saveConnection() {\n    const web3 = this.props.web3;\n    const contract = new web3.eth.Contract(TOKEN_ABI, TOKEN_ADDRESS);\n    var accounts = await web3.eth.getAccounts();\n    let password = await contract.methods.password(accounts[0]).call();\n    this.props.changeAccount(accounts[0]);\n    this.props.savePassword(password);\n    this.props.saveWeb3(web3);\n    this.props.saveContract(contract);\n    this.setState({\n      metamaskEnabled: true\n    });\n  }\n\n  async componentDidMount() {\n    let accountAlreadyConnected = false;\n\n    if (typeof window.ethereum !== \"undefined\") {\n      var web3 = new Web3(window.ethereum);\n      if ((await web3.eth.getAccounts()).length > 0) accountAlreadyConnected = true;\n      this.props.saveWeb3(web3);\n    }\n\n    if (accountAlreadyConnected) {\n      await this.connectMetamask();\n    } else {\n      this.setState({\n        metamaskEnabled: false\n      });\n    }\n  }\n\n  render() {\n    return /*#__PURE__*/_jsxDEV(_Fragment, {\n      children: [/*#__PURE__*/_jsxDEV(AppNav, {}, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 112,\n        columnNumber: 9\n      }, this), this.state.metamaskEnabled === false && window.innerWidth > 768 && /*#__PURE__*/_jsxDEV(ConnectMetamask, {\n        connMM: this.connectMetamask\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 114,\n        columnNumber: 11\n      }, this), /*#__PURE__*/_jsxDEV(Switch, {\n        children: [/*#__PURE__*/_jsxDEV(Redirect, {\n          exact: true,\n          from: \"/app\",\n          to: \"/app/login\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 117,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/app/login\",\n          children: /*#__PURE__*/_jsxDEV(Login, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 119,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 118,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/app/register\",\n          children: /*#__PURE__*/_jsxDEV(Register, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 122,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 121,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/app/unlocked\",\n          children: /*#__PURE__*/_jsxDEV(Unlocked, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 125,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 124,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/app/unlocked/addItem\",\n          children: /*#__PURE__*/_jsxDEV(AddItem, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 128,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 127,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          exact: true,\n          path: \"/app/unlocked/edit\",\n          children: /*#__PURE__*/_jsxDEV(EditItem, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 131,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 130,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(Route, {\n          children: /*#__PURE__*/_jsxDEV(NotFound, {}, void 0, false, {\n            fileName: _jsxFileName,\n            lineNumber: 134,\n            columnNumber: 13\n          }, this)\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 133,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 116,\n        columnNumber: 9\n      }, this)]\n    }, void 0, true);\n  }\n\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AppRouter);","map":{"version":3,"sources":["/home/danielmelchor/Documents/CodeProjects/Decentrapass/Website/src/routers/AppRouter.js"],"names":["React","Component","connect","changeAccount","saveWeb3","savePassword","saveContract","Switch","Route","Redirect","Web3","TOKEN_ABI","TOKEN_ADDRESS","AppNav","NotFound","ConnectMetamask","AddItem","EditItem","Login","Register","Unlocked","mapStateToProps","state","web3","mapDispatchToProps","dispatch","acc","web3item","Contract","pass","AppRouter","constructor","props","password","render","metamaskEnabled","connectMetamask","bind","saveConnection","accessAllowed","window","ethereum","request","method","e","console","log","on","accounts","location","reload","networkId","contract","eth","getAccounts","methods","call","setState","componentDidMount","accountAlreadyConnected","length","innerWidth"],"mappings":"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","sourcesContent":["import React, { Component } from \"react\";\nimport { connect } from \"react-redux\";\n\nimport {\n  changeAccount,\n  saveWeb3,\n  savePassword,\n  saveContract,\n} from \"../state/actions\";\n\nimport { Switch, Route, Redirect } from \"react-router-dom\";\n\nimport Web3 from \"web3\";\nimport { TOKEN_ABI, TOKEN_ADDRESS } from \"../web3/web3constants\";\n\nimport AppNav from \"../components/AppNav/AppNav\";\nimport NotFound from \"../pages/NotFound/NotFound\";\nimport ConnectMetamask from \"../components/Messages/ConnectMetamask\";\n\nimport AddItem from \"../pages/App/AddItem/AddItem\";\nimport EditItem from \"../pages/App/EditItem/EditItem\";\nimport Login from \"../pages/App/Login/Login\";\nimport Register from \"../pages/App/Register/Register\";\nimport Unlocked from \"../pages/App/Unlocked/Unlocked\";\n\nconst mapStateToProps = (state) => {\n  return {\n    web3: state.web3,\n  };\n};\n\nconst mapDispatchToProps = (dispatch) => {\n  return {\n    changeAccount: (acc) => dispatch(changeAccount(acc)),\n    saveWeb3: (web3item) => dispatch(saveWeb3(web3item)),\n    saveContract: (Contract) => dispatch(saveContract(Contract)),\n    savePassword: (pass) => dispatch(savePassword(pass)),\n  };\n};\n\nclass AppRouter extends Component {\n  constructor(props) {\n    super(props);\n    this.state = {\n      password: false,\n      render: null,\n      metamaskEnabled: null,\n    };\n\n    this.connectMetamask = this.connectMetamask.bind(this);\n    this.saveConnection = this.saveConnection.bind(this);\n  }\n\n  async connectMetamask() {\n    var accessAllowed = false;\n    try {\n      await window.ethereum.request({ method: \"eth_requestAccounts\" });\n      accessAllowed = true;\n    } catch (e) {\n      console.log(\"MM Error:\", e);\n    }\n\n    if (accessAllowed) {\n      await this.saveConnection();\n\n      window.ethereum.on(\"accountsChanged\", async function (accounts) {\n        window.location.reload();\n      });\n\n      window.ethereum.on(\"networkChanged\", function (networkId) {\n        window.location.reload();\n      });\n    }\n  }\n\n  async saveConnection() {\n    const web3 = this.props.web3;\n    const contract = new web3.eth.Contract(TOKEN_ABI, TOKEN_ADDRESS);\n\n    var accounts = await web3.eth.getAccounts();\n    let password = await contract.methods.password(accounts[0]).call();\n\n    this.props.changeAccount(accounts[0]);\n    this.props.savePassword(password);\n    this.props.saveWeb3(web3);\n    this.props.saveContract(contract);\n\n    this.setState({ metamaskEnabled: true });\n  }\n\n  async componentDidMount() {\n    let accountAlreadyConnected = false;\n    if (typeof window.ethereum !== \"undefined\") {\n      var web3 = new Web3(window.ethereum);\n\n      if ((await web3.eth.getAccounts()).length > 0)\n        accountAlreadyConnected = true;\n\n      this.props.saveWeb3(web3);\n    }\n\n    if (accountAlreadyConnected) {\n      await this.connectMetamask();\n    } else {\n      this.setState({ metamaskEnabled: false });\n    }\n  }\n\n  render() {\n    return (\n      <>\n        <AppNav />\n        {this.state.metamaskEnabled === false && window.innerWidth > 768 && (\n          <ConnectMetamask connMM={this.connectMetamask} />\n        )}\n        <Switch>\n          <Redirect exact from=\"/app\" to=\"/app/login\" />\n          <Route exact path=\"/app/login\">\n            <Login />\n          </Route>\n          <Route exact path=\"/app/register\">\n            <Register />\n          </Route>\n          <Route exact path=\"/app/unlocked\">\n            <Unlocked />\n          </Route>\n          <Route exact path=\"/app/unlocked/addItem\">\n            <AddItem />\n          </Route>\n          <Route exact path=\"/app/unlocked/edit\">\n            <EditItem />\n          </Route>\n          <Route>\n            <NotFound />\n          </Route>\n        </Switch>\n      </>\n    );\n  }\n}\n\nexport default connect(mapStateToProps, mapDispatchToProps)(AppRouter);\n"]},"metadata":{},"sourceType":"module"}